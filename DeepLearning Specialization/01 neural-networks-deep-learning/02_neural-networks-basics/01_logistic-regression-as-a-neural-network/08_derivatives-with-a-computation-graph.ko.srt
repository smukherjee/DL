1
00:00:00,510 --> 00:00:01,280
지난 강의에서

2
00:00:01,280 --> 00:00:06,130
이전 비디오에서는, 산출 그래프응 이용한 예제를 통해서 
J함수를 계산하는 방법을 배웠습니다.

3
00:00:06,130 --> 00:00:09,311
이제 깨끗한 전환을 통해
산출 그래프에 대해 알아보도록 하겠습니다.

4
00:00:09,311 --> 00:00:13,990
그리하겨, 이 그래프를 통해
J함수의 derivative를

5
00:00:13,990 --> 00:00:15,252
계산하는 방법을 알아보겠습니다.

6
00:00:15,252 --> 00:00:17,292
여기 산출 그래프가 있습니다.

7
00:00:17,292 --> 00:00:22,280
여러분이 J의 v에 대한 derivative를
계산하고 싶다고 해보겠습니다.

8
00:00:23,440 --> 00:00:24,126
이것을 무엇일까요?

9
00:00:24,126 --> 00:00:27,800
여기 v의 값을 갖고

10
00:00:27,800 --> 00:00:32,360
살짝 변경한다고 하면
J의 값은 어떻게 변할까요?

11
00:00:32,360 --> 00:00:37,553
여기서 J는 v의 값의 3배로 정의됩니다. 

12
00:00:37,553 --> 00:00:42,895
그리고 현재 v의 값은 11입니다.

13
00:00:42,895 --> 00:00:48,348
만약에 v의 값을 11.001로 조금 높히면, 

14
00:00:48,348 --> 00:00:52,524
J는 3v 이기 때문에, 현재 시점에는 그 값이 33입니다.

15
00:00:52,524 --> 00:00:56,130
이 값은 그러면 33.003으로 되겠죠.

16
00:00:56,130 --> 00:00:59,123
그러면 v의 값이 0.001로 늘어났습니다.

17
00:00:59,123 --> 00:01:03,640
그러면 최종 결과는 J가 3배로 늘어난다는 것입니다.

18
00:01:03,640 --> 00:01:08,099
그러면 J의 v에 대한derivative는 3입니다.

19
00:01:08,099 --> 00:01:12,590
J의 증가분은 v의 증가분의 3배이이 때문입니다.

20
00:01:12,590 --> 00:01:18,221
이 예제는 이전 비디오에서 다뤘던 예제와

21
00:01:18,221 --> 00:01:24,670
유사한데요, f(a)=3a 였던 예제와 말이죠. 

22
00:01:24,670 --> 00:01:30,765
그 이후, df/da를 약간 심플하게 만들어서 가지고 왔는데요, 

23
00:01:30,765 --> 00:01:36,740
대충 표현하면, df/da = 3으로 나타낼 수 있습니다.

24
00:01:36,740 --> 00:01:41,829
그러므로 이렇게 J = 3v로 나타나는데요, 

25
00:01:41,829 --> 00:01:44,825
이 경우, dJ/dv는 3이 됩니다.

26
00:01:44,825 --> 00:01:51,713
여기서는 J가 f의 역할을 하는데요, 

27
00:01:51,713 --> 00:01:58,323
이전 비디오 예제에서 v는 a의 역할을 학구요, 

28
00:01:58,323 --> 00:02:03,595
그러므로 후 방향전파의 용어에서 

29
00:02:03,595 --> 00:02:09,617
만약 여기 마지막 변수 결과값의 derivative를 산출하고 싶은 경우, 

30
00:02:09,617 --> 00:02:13,475
주로 가장 신경쓰는 변수이기도 합니다만, 

31
00:02:13,475 --> 00:02:18,790
v에 대한 값인데요, 후 방향전파의 첫번째 단계를 진행했습니다.

32
00:02:18,790 --> 00:02:22,240
이 그래프에서 one step backwards라고 합니다.

33
00:02:22,240 --> 00:02:24,280
다른 예제를 하나 더 보겠습니다.

34
00:02:24,280 --> 00:02:28,180
dJ/da 는 무엇일까요?

35
00:02:28,180 --> 00:02:33,670
다시 말해, a의 값을 올리면, 이것이 
J의 값에 어떤 영향을 미칠까요?

36
00:02:35,420 --> 00:02:39,965
예제를 통해 살펴보겠습니다. 
여기서 a의 값은 5입니다.

37
00:02:39,965 --> 00:02:42,850
이제 이 값을 5.001로 올려보겠습니다.

38
00:02:42,850 --> 00:02:48,790
순영향은 v가 이전에는 a+u였죠, 
이 값이 11이였는데요, 

39
00:02:48,790 --> 00:02:52,359
이제 이 값이 11.001이 될 것입니다.

40
00:02:52,359 --> 00:02:57,224
그리고 이미 위와 같이 봤습니다만, 

41
00:02:57,224 --> 00:03:01,672
J의 값은 33.003으로 증가합니다.

42
00:03:01,672 --> 00:03:07,591
그러면 여기서 볼 수 있는 것은 
0.001만큼 증가시키면 J는 0.003만큼 증가합니다.

43
00:03:07,591 --> 00:03:11,751
여기서 a 증가라고 하는 것은 
여기 5라는 값에 

44
00:03:11,751 --> 00:03:14,100
새로운 값을 대입시키는 것입니다.

45
00:03:14,100 --> 00:03:17,954
그러면 a의 변화는 그래프의 오른족으로 반영되어 

46
00:03:17,954 --> 00:03:19,832
J의 값이 33.003이 될 것입니다.

47
00:03:19,832 --> 00:03:28,110
그러면 J의 증가가 a의 증가분과 비교하였을 때 3배가 되는 것입니다.

48
00:03:28,110 --> 00:03:31,520
그러면 여기 derivative값은 3이라는 것입니다.

49
00:03:31,520 --> 00:03:37,400
이것을 간단히 분해해서 설명하면
a를 변경하면

50
00:03:37,400 --> 00:03:38,910
그 변경한 값이 v를 변경할 것입니다.

51
00:03:40,130 --> 00:03:43,967
그렇게 v가 변경되면 
그 변화는 또 J를 변경시킬 것입니다.

52
00:03:43,967 --> 00:03:49,554
그러므로 값을 증가시켰을 때의 총 J의 총 변화는, 

53
00:03:49,554 --> 00:03:54,313
a의 값을 아주 조금 올렸을 때, 

54
00:03:57,699 --> 00:04:02,561
a를 변경하면서, v를 증가시키게 됩니다.

55
00:04:02,561 --> 00:04:05,850
그러면 v는 얼마나 늘어날까요?

56
00:04:05,850 --> 00:04:11,709
dv/da로 결정된 만큼 증가할 것입니다.

57
00:04:11,709 --> 00:04:19,802
그리고 v의 변화량이 J를 증가시킬 것입니다. 

58
00:04:19,802 --> 00:04:27,064
그리하여 미적분에서는 이것을 chain rule이라고 하는데요, 
a가 v에 영향을 주면, 

59
00:04:27,064 --> 00:04:32,023
J에 영향을 주고, 
a의 값을 약간 변경하면서 J가 변하는 양은 

60
00:04:32,023 --> 00:04:36,866
a를 변화시킬때 변하는 v의 양 곱하기

61
00:04:36,866 --> 00:04:42,165
v값이 변할때 변하는 J의 양입니다. 

62
00:04:42,165 --> 00:04:46,225
다시 말씀드리면, 미적분에서는 
이것을 chain rule이라 합니다.

63
00:04:46,225 --> 00:04:52,140
이번 계산을 통해 배운 것은, 
값을 0.001로 증가시키면, 

64
00:04:52,140 --> 00:04:55,250
v도 똑같은 양 만큼 변한다는 것입니다.

65
00:04:55,250 --> 00:04:59,650
그러므로 dv/da의 값은 1이 됩니다.

66
00:04:59,650 --> 00:05:07,774
이전에 끝낸 값을 대입시키면, 

67
00:05:07,774 --> 00:05:11,700
dv/dJ는 3이되고, dv/da는 1이 됩니다. 

68
00:05:11,700 --> 00:05:14,160
이 값의 곱셈은 3곱하기 1이구요, 

69
00:05:14,160 --> 00:05:18,350
그러면, 알맞은 값인 dJ//da의 값이 3이 나옵니다.

70
00:05:18,350 --> 00:05:24,963
이렇게 나온 값과 같이, 
dJ/dv, 

71
00:05:24,963 --> 00:05:30,183
즉, 이 변수에 대한 derivative값인데요, 

72
00:05:30,183 --> 00:05:34,030
이 값을 통해 dJ/da도 계산을 할 수 있습니다.

73
00:05:34,030 --> 00:05:37,270
또 다른 역산출의 예입니다.

74
00:05:39,900 --> 00:05:44,115
표기법에 관련해 한가지 말씀드릴 것이 있는데요, 

75
00:05:44,115 --> 00:05:50,005
후 방향전파 도입을 위해 코드를 쓰는 경우, 

76
00:05:50,005 --> 00:05:54,675
여러분이 정말로 신경쓰는 결과값 변수가 있을 것입니다.

77
00:05:54,675 --> 00:06:01,065
이런 결과값 변수는 여러분이 최적화 시키고 싶은 값이디고 하죠.

78
00:06:01,065 --> 00:06:04,100
이런 케이스의 경우, 최종 결과값 변수는 J입니다.

79
00:06:04,100 --> 00:06:07,460
여러분의 산출 그래프에서 마지막 노드에 해당하는 부분입니다.

80
00:06:07,460 --> 00:06:11,870
그러므로, 수 많은 산출 그래프들이 최동 결과값 변수에 대한

81
00:06:11,870 --> 00:06:13,343
derivative값을 산출하려고 할 것입니다.

82
00:06:13,343 --> 00:06:17,100
즉, 다른 어떤 변수에 대한 최종 결과값 변수의 d 겠죠. 

83
00:06:17,100 --> 00:06:23,319
이것을 dvar라고 하겠습니다.

84
00:06:23,319 --> 00:06:27,909
이렇게 최종 결과값 변수에 대한 derivative값 J와 같이 

85
00:06:27,909 --> 00:06:32,164
계산하는 경우가 많을 것입니다.
중간중간 변수들이 있는 경우이죠. 

86
00:06:32,164 --> 00:06:34,520
변수들은 a, b, c, u, 또는 v와 같을 수 있습니다.

87
00:06:34,520 --> 00:06:41,280
이것을 소프트웨어에 도입시키면 
이런 변수를 뭐라고 부를까요? 

88
00:06:41,280 --> 00:06:44,208
한가지 할 수 있는 방법은 파이썬에서, 

89
00:06:44,208 --> 00:06:50,280
아주 긴 이름을 부여할 수 있습니다.
dFinalOurputVar/dvar와 같이 말이죠. 

90
00:06:50,280 --> 00:06:51,766
하지만 이것은 너무 긴 변수 이름이겠죠. 

91
00:06:51,766 --> 00:06:55,018
제 생각에는 dJdvar라고 부를 수도 있을 것 같습니다.

92
00:06:55,018 --> 00:06:58,929
하지만 여려분은 dJ에 대해서 derivative값을 갖기 때문에, 

93
00:06:58,929 --> 00:07:03,173
즉, 여기 최종 결과값 변수에 대해서 말이죠.
그러므로 새로운 표기법을 소개하겠습니다.

94
00:07:03,173 --> 00:07:09,635
코딩에서, 여기 이것을 산출할때, 

95
00:07:09,635 --> 00:07:16,936
그냥 dvar이라는 변수이름을 사용하겠습니다.
여기 이 양을 나타내기 위해서 말이죠. 

96
00:07:16,936 --> 00:07:21,459
그러므로 코드에서 쓰는 dvar는

97
00:07:21,459 --> 00:07:25,444
J와 같은 최종 결과값 변수의 derivative를 나타낼 것입니다.

98
00:07:25,444 --> 00:07:29,938
가끔씩은 코딩에서 여러 중간 값의 양에 대한 

99
00:07:29,938 --> 00:07:31,795
마지막 l을 나타낼 것입니다.

100
00:07:31,795 --> 00:07:38,380
그러므로 코딩에서 여기 이 부분은
dv를 사용해서 이 값을 나타냅니다.

101
00:07:38,380 --> 00:07:42,453
그러면 dv는 3이 될 것입니다.

102
00:07:42,453 --> 00:07:46,635
그러면 여러분의 코드는, 여기 이것을 da로 표기하느데요, 

103
00:07:46,635 --> 00:07:51,185
여기서 이 값은 3이라는 것을 알아냈는데요, 

104
00:07:51,185 --> 00:07:58,018
저희는 이 산출 그래프를 통해
부분적으로 후 방향전파 진행했는데요, 

105
00:07:58,018 --> 00:08:02,130
나머지 부분은 다음 슬라이드에서 진행하겠습니다.

106
00:08:02,130 --> 00:08:06,293
이제 깨끗한 버전의 산출그래프로 이동하겠습니다.

107
00:08:06,293 --> 00:08:09,846
반복하자면, 이제까지는

108
00:08:09,846 --> 00:08:14,743
여기서 거꾸로가서, 
dv의 값이 3이라는 것을 알아냈습니다.

109
00:08:14,743 --> 00:08:18,783
그리고 dv의 정의, 이것은 그냥 변수 이름이구요, 

110
00:08:18,783 --> 00:08:20,844
코드가 dJ/dv입니다.

111
00:08:20,844 --> 00:08:24,303
da의 값이 3이라는 것을 찾았습니다.

112
00:08:24,303 --> 00:08:30,470
da는 역시 여러분의 코드에서 쓰이는 변수 이름인데요, 이것은, dJ/da의 값입니다.

113
00:08:32,332 --> 00:08:39,410
그리고 우리는 우리가 어떻게 이렇게 두 모서리를 거꾸로 갈 수 있는지 조심해야 한다.

114
00:08:39,410 --> 00:08:41,262
그럼 계속해서 derivative를 계산해보겠습니다.

115
00:08:41,262 --> 00:08:44,129
u의 값을 보겠습니다.

116
00:08:44,129 --> 00:08:47,473
dJ/du 는 무엇일까요?

117
00:08:47,473 --> 00:08:52,153
이전에 계산했던 것과 비슷하게, 

118
00:08:52,153 --> 00:08:54,430
u는6이라는 값으로 시작합니다.

119
00:08:54,430 --> 00:08:57,913
u의 값을 6.001로 증가시키면, v는 

120
00:08:57,913 --> 00:09:02,700
이전에 11이였는데요, 이 값이 11.001이 됩니다.

121
00:09:02,700 --> 00:09:07,978
그럼 J는 33에서 33.003이 됩니다.

122
00:09:07,978 --> 00:09:12,190
그러면 J의 증가분은 3배인데요, 

123
00:09:12,190 --> 00:09:16,760
u에 대한 분석은 우리가 이미 실행한 
a에 대한 분석과 매우 흡사합니다.

124
00:09:16,760 --> 00:09:23,884
이것은 dJ/dv 곱하기 dv/du로 계산되는데요, 

125
00:09:23,884 --> 00:09:30,186
이것은 이전에 계산한것과 같이 3입니다.

126
00:09:30,186 --> 00:09:33,800
그리고 이것은 1이구요. 

127
00:09:33,800 --> 00:09:36,950
그러면 후 방향전파에서 또 한단계 진행했는데요, 

128
00:09:36,950 --> 00:09:42,920
du는 또, 3이라는 결과를 계산합니다.

129
00:09:42,920 --> 00:09:47,240
그리고 du 당연히 여기 dJ/du 입니다.

130
00:09:47,240 --> 00:09:51,570
마지막 예제로 들어가겠습니다.

131
00:09:51,570 --> 00:09:54,137
dJ/db는 무엇일까요?

132
00:09:54,137 --> 00:09:57,255
여기서 b의 값을 바꿔도 된다고 해봅시다. 

133
00:09:57,255 --> 00:10:01,585
b를 조금 바꿔서 J의 값을 

134
00:10:01,585 --> 00:10:04,040
최소화 시키거나 최대화시키기 위해서 말이죠. 

135
00:10:04,040 --> 00:10:05,340
그러면 여기 J비용함수의 기울기는 또는 

136
00:10:05,340 --> 00:10:10,860
derivative는 b의 값을 조금 바꾸는 경우 
어떻게 될까요?

137
00:10:11,880 --> 00:10:15,257
미적분학의 chain rule을 이용하여, 

138
00:10:15,257 --> 00:10:18,416
2가지 값의 곱하기로 나타낼 수 있습니다.

139
00:10:18,416 --> 00:10:24,720
여기 dJ/du 곱하기 du/db로 말이죠. 

140
00:10:24,720 --> 00:10:30,390
그 원리는, 
b를 조금 바꾼다고하면, 

141
00:10:30,390 --> 00:10:34,275
즉 b를 3에서 3.001로 말이죠. 

142
00:10:34,275 --> 00:10:38,041
J가 미치는 영향은, 먼저 U가 먼저 영향을 받을 것입니다.

143
00:10:38,041 --> 00:10:40,120
그러면 u는 얼마나 영향을 받을까요?

144
00:10:40,120 --> 00:10:44,100
u는 b곱하기 c로 정의되는데요, 

145
00:10:44,100 --> 00:10:48,073
그럼 이값은 6에서 

146
00:10:48,073 --> 00:10:53,238
b가 3인 경우에 말이죠, 6.002로 변할 것입니다.

147
00:10:53,238 --> 00:10:59,560
여기서 c의 값은 2이기 때문에 그렇습니다., 

148
00:10:59,560 --> 00:11:05,150
그러면 du/db는 2라는 것을 알려줍니다.

149
00:11:05,150 --> 00:11:10,490
그러면 b를 0.001로 증가시키면, 
u는 그것의 2배만큼 증가합니다.

150
00:11:10,490 --> 00:11:15,360
즉, du/db는 2가 됩니다.

151
00:11:15,360 --> 00:11:21,430
이제 u의 값이 2배로 늘어난 것을 확인할 수 있는데요, b가 늘어난 것과 비교했을 때 말이죠, 

152
00:11:21,430 --> 00:11:24,460
그러면 dJ/du는 무엇일까요?

153
00:11:24,460 --> 00:11:27,447
이것은 이미 3이라는 것을 알아냈었습니다.

154
00:11:27,447 --> 00:11:32,850
그럼 이 값들을 곱해서 
dJ/db가 6이라는 것을 알 수 있습니다.

155
00:11:32,850 --> 00:11:36,274
그리고 두번째 부분에 대한 설명입니다.

156
00:11:36,274 --> 00:11:43,370
u의 값이 0.002 만큼 늘어나면 J의 영향은 어떻게 되는지에 대한
설명말이죠, 

157
00:11:43,370 --> 00:11:48,746
dJ/du가 3이라는 사실은 

158
00:11:48,746 --> 00:11:54,310
u가 0.002만큼 늘어나면 J의 값은 그것의 3배만큼 늘어난다는 뜻입니다.

159
00:11:54,310 --> 00:11:59,943
즉, J는 0.006만큼 늘어나겠죠.

160
00:11:59,943 --> 00:12:05,670
이것은 dJ/du가 3이라는 사실에 근거합니다.

161
00:12:05,670 --> 00:12:09,351
수학적인 부분을 자세히 보면, 

162
00:12:09,351 --> 00:12:13,891
d가 3.001이 된다는 것을 알게되고, 

163
00:12:13,891 --> 00:12:20,190
그러면 u는 6.002가 되면, 결국 v는 11.002가 됩니다.

164
00:12:20,190 --> 00:12:24,064
그러면 저것은 a+u이고, 저것은 5+u가 됩니다.

165
00:12:24,064 --> 00:12:28,450
J는 3곱하기 v이며, 

166
00:12:28,450 --> 00:12:33,101
그 값은 33.006이 됩니다.

167
00:12:33,101 --> 00:12:37,695
이렇게해서 dJ/db값은 6이 나오게 되는데요, 

168
00:12:37,695 --> 00:12:43,738
이 부분을 채우기 위해서는, 거꾸로 가는 경우 말이죠, 
이건 db이고 그 값이 6입니다.

169
00:12:43,738 --> 00:12:50,347
db는 쉽게 말해 dJ/db의 파이썬 변수 코드 이름입니다.

170
00:12:50,347 --> 00:12:53,565
마지막 예제는 자세히 들어가진 않겠습니다.

171
00:12:53,565 --> 00:13:00,423
dJ를 계산하면, 

172
00:13:00,423 --> 00:13:05,748
여기 이 값은 dJ/du 곱하기 du가 되는데요, 

173
00:13:05,748 --> 00:13:09,987
그러면 여기 이 값은 9가 되고, 
이 값은 3곱하기 3입니다.

174
00:13:09,987 --> 00:13:11,950
이 예제는 자세히 다루지 않겠습니다.

175
00:13:11,950 --> 00:13:18,720
여기 마지막 단계를 통해, 
dc가 이렇다는 것을 알아낼 수 있습니다. 

176
00:13:20,060 --> 00:13:24,634
이 비디오에서 중요한 내용은, 
여기 예제에서와 같이

177
00:13:24,634 --> 00:13:29,347
derivative를 계산하고, 여기 모든 derivative들을 계산할때, 
가장 효율적인 방법은 

178
00:13:29,347 --> 00:13:34,221
여기 빨간색 화살표와 같은 방향으로 오른쪽에서 왼쪽으로의 계산을 진행하는 것입니다.

179
00:13:34,221 --> 00:13:37,780
특리 v에 대한 derivative를 먼저 계산하겠습니다.

180
00:13:37,780 --> 00:13:40,530
그러면 저것이 

181
00:13:40,530 --> 00:13:45,410
a에 대해서 derivative를 찾는 것과
u에 대해서 derivative를 찾을 때 유용하게 쓰입니다.

182
00:13:45,410 --> 00:13:48,070
그리고 여기 이 예제에서 u에 대한 derivative

183
00:13:48,070 --> 00:13:52,020
여기 이 항과 여기 이 항의 같은 경우과 같이 말이죠. 

184
00:13:52,020 --> 00:13:55,430
이것들은 결과적으로 b에 대해서 derivative를 찾는데 
유용하게 쓰입니다.

185
00:13:55,430 --> 00:13:57,610
c에 대해서 derivative를 구할때도 마찬가지로 말이죠. 

186
00:13:57,610 --> 00:14:02,370
이제까지 산출 그래프 내용을 이야기 했는데요, 

187
00:14:02,370 --> 00:14:07,620
또, 최적화 시키고 싶은 J비용함수에서 계산하는 forward, left to right 계산법에 대해 알아봤습니다

188
00:14:07,620 --> 00:14:12,940
그리고 derivative를 산출하기 위한 backwards, right to left 계산법도 알아봤습니다.

189
00:14:12,940 --> 00:14:15,422
여러분이 만약 미적분학이나 chain rule에 대한 내용이 생소하게 들리시면, 

190
00:14:15,422 --> 00:14:18,382
저도 이런 내용을 빨리 진행해서 넘어갔는데요, 

191
00:14:18,382 --> 00:14:21,500
자세한 내용을 모르시더라도 걱정하지 마십시요. 

192
00:14:21,500 --> 00:14:22,567
다음 비디오에서는

193
00:14:22,567 --> 00:14:26,251
로지스틱 회귀분석법에 연관지어 다시 그 내용을 알아보도록 하겠습니다.

194
00:14:26,251 --> 00:14:30,337
그리하여 산출법을 도입하기 위해서 정확히 어떻게 해야하는지

195
00:14:30,337 --> 00:14:33,780
로지스틱 회귀분석 모델의 derivative를 계산하기 위한 방법을 다뤄보겠습니다.
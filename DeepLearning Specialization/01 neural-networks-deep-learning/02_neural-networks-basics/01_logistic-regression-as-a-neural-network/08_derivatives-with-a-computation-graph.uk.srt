1
00:00:00,510 --> 00:00:01,280
В останньому відео

2
00:00:01,280 --> 00:00:06,130
ми розглянули приклад використання Діаграми обчислень 
для функції J.

3
00:00:06,130 --> 00:00:09,311
Тепер давай розглянемо зворотну версію Діаграми обчислень

4
00:00:09,311 --> 00:00:13,990
і подивимось як її можна використовувати для обчислення похідних

5
00:00:13,990 --> 00:00:15,252
функції J.

6
00:00:15,252 --> 00:00:17,292
Ось Діаграма обчислень.

7
00:00:17,292 --> 00:00:22,280
Скажімо, ми хочемо обчислити [часткову] похідну J по v.

8
00:00:23,440 --> 00:00:24,126
Що це означає?

9
00:00:24,126 --> 00:00:27,800
Це значить, що якщо ми візьмемо значення v і

10
00:00:27,800 --> 00:00:32,360
трохи змінимо його... Як же зміниться значення J?

11
00:00:32,360 --> 00:00:37,553
Що ж, J визначається як 3v

12
00:00:37,553 --> 00:00:42,895
і в даний момент v=11.

13
00:00:42,895 --> 00:00:48,348
Тож якщо ми трохи збільшимо v до 11,001,

14
00:00:48,348 --> 00:00:52,524
то J, яка =3v, тобто 33,

15
00:00:52,524 --> 00:00:56,130
збільшиться до 33,003.

16
00:00:56,130 --> 00:00:59,123
Тож ми збільшили v на 0,001

17
00:00:59,123 --> 00:01:03,640
і в результаті J збільшується на втричі більше.

18
00:01:03,640 --> 00:01:08,099
Тож [часткова] похідна J по v =3.

19
00:01:08,099 --> 00:01:12,590
Тому що збільшення J втричі більше збільшення v.

20
00:01:12,590 --> 00:01:18,221
І це дуже схоже на приклад

21
00:01:18,221 --> 00:01:24,670
з попереднього відео, де ми мали f(a)=3a.

22
00:01:24,670 --> 00:01:30,765
І ми тоді вивели, що df(a)/da

23
00:01:30,765 --> 00:01:36,740
(при дещо спрощеному, дещо недбалому записі) 
можна записати як df/da=3

24
00:01:36,740 --> 00:01:41,829
Зараз у нас J=3v,

25
00:01:41,829 --> 00:01:44,825
тож dJ/dv=3.

26
00:01:44,825 --> 00:01:51,713
Тож J тут грає роль f(a),

27
00:01:51,713 --> 00:01:58,323
а v грає роль a з попереднього прикладу попереднього відео.

28
00:01:58,323 --> 00:02:03,595
Тож, справді, згідно термінології зворотного поширення, як бачимо,

29
00:02:03,595 --> 00:02:09,617
якщо ми хочемо обчислити [часткову] похідну по остаточній змінній

30
00:02:09,617 --> 00:02:13,475
(яка, як правило, є найбільш потрібною),

31
00:02:13,475 --> 00:02:18,790
по v, то це можна зробити одним кроком зворотного поширення.

32
00:02:18,790 --> 00:02:22,240
Це ми називаємо одним кроком назад на цій діаграмі.

33
00:02:22,240 --> 00:02:24,280
Тепер давай розглянемо інший приклад.

34
00:02:24,280 --> 00:02:28,180
Що таке dJ/da?

35
00:02:28,180 --> 00:02:33,670
Іншими словами, 
якщо ми трохи змінимо значення a, то як це вплине на J?

36
00:02:35,420 --> 00:02:39,965
Що ж, давай рухатись далі. Зараз a=5.

37
00:02:39,965 --> 00:02:42,850
Давай збільшимо його до 5,001.

38
00:02:42,850 --> 00:02:48,790
В результаті v, яке =a+u, що =11,

39
00:02:48,790 --> 00:02:52,359
збільшиться до 11,001.

40
00:02:52,359 --> 00:02:57,224
І далі, як ми вже бачили вище,

41
00:02:57,224 --> 00:03:01,672
J збільшиться до 33,003.

42
00:03:01,672 --> 00:03:07,591
То ж ми бачимо, що 
якщо збільшити a на 0,001, J збільшиться на 0,003.

43
00:03:07,591 --> 00:03:11,751
І під збільшенням я маю на увазі, що ми можемо замість 5

44
00:03:11,751 --> 00:03:14,100
підставити для a нове значення.

45
00:03:14,100 --> 00:03:17,954
Далі зміна a пошириться вправо по Діаграмі обчислень,

46
00:03:17,954 --> 00:03:19,832
і J стане 33,003.

47
00:03:19,832 --> 00:03:28,110
І, отже, збільшення J втричі більше збільшення a.

48
00:03:28,110 --> 00:03:31,520
А це значить, що ця похідна =3.

49
00:03:31,520 --> 00:03:37,400
Якщо розбити це на частини, то ми побачимо, що зміна a

50
00:03:37,400 --> 00:03:38,910
веде до зміни v,

51
00:03:40,130 --> 00:03:43,967
а зміна v веде до зміни J. Тож

52
00:03:43,967 --> 00:03:49,554
остаточна зміна значення J, коли ми збільшуємо,

53
00:03:49,554 --> 00:03:54,313
коли ми дещо підштовхуємо значення a догори, це те, що

54
00:03:57,699 --> 00:04:02,561
зміна a збільшує [змінює] v.

55
00:04:02,561 --> 00:04:05,850
Що ж, наскільки v збільшується [змінюється]?

56
00:04:05,850 --> 00:04:11,709
Воно збільшується [змінюється] на величину визначену dv/da.

57
00:04:11,709 --> 00:04:19,802
І зміна v приведе також до збільшення [зміни] J.

58
00:04:19,802 --> 00:04:27,064
Тож в диф.численні це називається ланцюговим правилом 
[правило диференціювання складної функції]. Тобто,

59
00:04:27,064 --> 00:04:32,023
якщо a впливає на v, а це впливає на J, 
то величина, на яку змінюється J при

60
00:04:32,023 --> 00:04:36,866
зміні a, буде добутком величини зміни v при

61
00:04:36,866 --> 00:04:42,165
зміні a і величини зміни J при зміні v.

62
00:04:42,165 --> 00:04:46,225
Тож в диф.численні це зветься ланцюговим правилом.

63
00:04:46,225 --> 00:04:52,140
Тож, як ми бачимо з цих обчислень, якщо збільшити a на 0,001,

64
00:04:52,140 --> 00:04:55,250
v збільшиться на цю ж величину.

65
00:04:55,250 --> 00:04:59,650
Тож dv/da=1.

66
00:04:59,650 --> 00:05:07,774
Тож, якщо підставити те, що ми записали щойно - dJ/dv=3

67
00:05:07,774 --> 00:05:11,700
і dv/da=1 -

68
00:05:11,700 --> 00:05:14,160
то добуток 3 і 1

69
00:05:14,160 --> 00:05:18,350
дасть нам правильне значення dJ/da=3.

70
00:05:18,350 --> 00:05:24,963
Тож ця маленька ілюстрація показує як, маючи обчислене dJ/dv

71
00:05:24,963 --> 00:05:30,183
(що є [частковою] похідною по цій змінній), 
це може допомогти обчислити

72
00:05:30,183 --> 00:05:34,030
dJ/da.

73
00:05:34,030 --> 00:05:37,270
Тож це наступний крок - зворотне обчислення.

74
00:05:39,900 --> 00:05:44,115
Хочу представити ще одну нотативну конвенцію.

75
00:05:44,115 --> 00:05:50,005
Це коли ми пишемо код реалізації зворотного поширення,

76
00:05:50,005 --> 00:05:54,675
ми зазвичай маємо певну остаточну дуже важливу змінну.

77
00:05:54,675 --> 00:06:01,065
Певну остаточну дуже важливу змінну, яку ми хочемо оптимізувати.

78
00:06:01,065 --> 00:06:04,100
В цьому випадку ця остаточна змінна - J.

79
00:06:04,100 --> 00:06:07,460
Це останній вузол в нашій Діаграмі обчислень.

80
00:06:07,460 --> 00:06:11,870
І, отже, багато обчислень намагатимуться обчислити похідну

81
00:06:11,870 --> 00:06:13,343
остаточної змінної.

82
00:06:13,343 --> 00:06:17,100
Тож d цієї остаточної змінної по деякій іншій змінній,

83
00:06:17,100 --> 00:06:23,319
ми називаємо dvar.

84
00:06:23,319 --> 00:06:27,909
Тож багато обчислень, 
які нас чекають, будуть обчислювати [часткові] похідні остаточної

85
00:06:27,909 --> 00:06:32,164
змінної (J в даному випадку) по різних проміжних змінних, таких як

86
00:06:32,164 --> 00:06:34,520
a, b, c, u або v.

87
00:06:34,520 --> 00:06:41,280
І коли ми почнемо реалізувати це в програмі, 
як нам назвати цю змінну?

88
00:06:41,280 --> 00:06:44,208
Одним зі способів у Python

89
00:06:44,208 --> 00:06:50,280
може бути довжелезне ім'я типу dFinalOutputVar/dvar.

90
00:06:50,280 --> 00:06:51,766
Проте, це дуже довге ім'я для змінної.

91
00:06:51,766 --> 00:06:55,018
Ти можеш назвати її, думаю, dJdvar.

92
00:06:55,018 --> 00:06:58,929
Але через те, що ми завжди братимемо похідні від dJ,

93
00:06:58,929 --> 00:07:03,173
від цієї остаточної змінної, я представлю нове позначення.

94
00:07:03,173 --> 00:07:09,635
Згідно якого, 
в коді (при обчисленні ось цього), який ми будемо писати,

95
00:07:09,635 --> 00:07:16,936
ми будемо просто використовувати dvar 
для позначення цього виразу.

96
00:07:16,936 --> 00:07:21,459
Тож dvar в коді, який ми будемо писати, буде позначати похідну,

97
00:07:21,459 --> 00:07:25,444
остаточну дуже важливу змінну типу J.

98
00:07:25,444 --> 00:07:29,938
А інколи - Втрату L по відношенню до різних проміжних рівнянь,

99
00:07:29,938 --> 00:07:31,795
які ти обчислюватимеш в коді.

100
00:07:31,795 --> 00:07:38,380
Тож ось це в коді буде позначатись dv.

101
00:07:38,380 --> 00:07:42,453
Тобто dv буде =3.

102
00:07:42,453 --> 00:07:46,635
А в коді буде позначатись як da.

103
00:07:46,635 --> 00:07:51,185
І воно теж буде =3.

104
00:07:51,185 --> 00:07:58,018
Тож з допомогою цієї Діаграми обчислень 
ми частково здійснили зворотне поширення.

105
00:07:58,018 --> 00:08:02,130
Давай завершимо розглядати цей приклад на наступному слайді.

106
00:08:02,130 --> 00:08:06,293
Тож давай зробимо чисту копію Діаграми обчислень

107
00:08:06,293 --> 00:08:09,846
і резюмуємо, що ми зробили до цього моменту.

108
00:08:09,846 --> 00:08:14,743
Ми повернулись сюди і знайшли, що dv=3.

109
00:08:14,743 --> 00:08:18,783
І, знову ж, за визначенням dv - це просто назва змінної, а в коді -

110
00:08:18,783 --> 00:08:20,844
це справді dJ/dv.

111
00:08:20,844 --> 00:08:24,303
Ми знайшли, що da=3.

112
00:08:24,303 --> 00:08:30,470
І, знову ж, da - це назва змінної в коді, а насправді - значення dJ/da.

113
00:08:32,332 --> 00:08:39,410
Ми, ніби, подаємо руку у відповідь 
[в зворотному напрямку] стосовно цих двох блоків.

114
00:08:39,410 --> 00:08:41,262
Тепер давай продовжимо обчислювати похідні.

115
00:08:41,262 --> 00:08:44,129
Давай подивимось на значення u.

116
00:08:44,129 --> 00:08:47,473
Тож чому =dJ/du?

117
00:08:47,473 --> 00:08:52,153
Що ж, скористаємось схожими обчисленнями, які ми вже робили.

118
00:08:52,153 --> 00:08:54,430
Почнемо з того, що u=6.

119
00:08:54,430 --> 00:08:57,913
Якщо ми трохи збільшимо його до 6,001, то v,

120
00:08:57,913 --> 00:09:02,700
що =11, збільшиться до 11,001.

121
00:09:02,700 --> 00:09:07,978
І, отже, J зміниться з 33 до 33,003.

122
00:09:07,978 --> 00:09:12,190
Тож збільшення J - трикратне і =3.

123
00:09:12,190 --> 00:09:16,760
А аналіз u дуже схожий до аналізу, який ми робили для a.

124
00:09:16,760 --> 00:09:23,884
Воно обчислюється як dJ/dv помножити на

125
00:09:23,884 --> 00:09:30,186
dv/du, а ми вже обчислили, що це буде 3.

126
00:09:30,186 --> 00:09:33,800
А ось це буде =1.

127
00:09:33,800 --> 00:09:36,950
Тож ми закінчили ще один крок зворотного поширення.

128
00:09:36,950 --> 00:09:42,920
В результаті обчислень ми отримали, що du також =3.

129
00:09:42,920 --> 00:09:47,240
Під du ми, звичайно, маємо на увазі dJ/du.

130
00:09:47,240 --> 00:09:51,570
І тепер востаннє детально пройдемо наступний крок.

131
00:09:51,570 --> 00:09:54,137
Тож чому =dJ/db?

132
00:09:54,137 --> 00:09:57,255
Уявімо, що ми можемо змінювати значення b,

133
00:09:57,255 --> 00:10:01,585
тобто налаштовувати його так,

134
00:10:01,585 --> 00:10:04,040
щоб мінімізувати або максимізувати значення J.

135
00:10:04,040 --> 00:10:05,340
Тож яка похідна чи

136
00:10:05,340 --> 00:10:10,860
який нахил цієї функції J, якщо ми трохи змінимо значення b?

137
00:10:11,880 --> 00:10:15,257
Виявляється, 
що, використовуючи ланцюгове правило диф.числення,

138
00:10:15,257 --> 00:10:18,416
це можна записати як добуток двох виразів:

139
00:10:18,416 --> 00:10:24,720
dJ/du і du/db.

140
00:10:24,720 --> 00:10:30,390
Міркування наступні. Якщо трохи змінити b,

141
00:10:30,390 --> 00:10:34,275
скажімо з 3 до 3,001,

142
00:10:34,275 --> 00:10:38,041
то перед тим як змінити J, це спочатку змінить u.

143
00:10:38,041 --> 00:10:40,120
Наскільки це змінить u?

144
00:10:40,120 --> 00:10:44,100
Що ж, u визначається як b*c.

145
00:10:44,100 --> 00:10:48,073
Тож воно зміниться від 6

146
00:10:48,073 --> 00:10:53,238
(бо b=3) до 6,002,

147
00:10:53,238 --> 00:10:59,560
тому c=2 в даному прикладі.

148
00:10:59,560 --> 00:11:05,150
Тобто ми отримаємо, що du/db=2.

149
00:11:05,150 --> 00:11:10,490
Тому що коли збільшуємо b на 0,001, 
u збільшується на вдвічі більшу величину.

150
00:11:10,490 --> 00:11:15,360
Тож du/db=2.

151
00:11:15,360 --> 00:11:21,430
Тож тепер ми знаємо, 
що u збільшиться на вдвічі більшу величину ніж b.

152
00:11:21,430 --> 00:11:24,460
Тож чому =dJ/du?

153
00:11:24,460 --> 00:11:27,447
Ми вже визначили, що воно =3.

154
00:11:27,447 --> 00:11:32,850
І, отже, перемноживши ось ці 2 вирази, ми отримаємо, що dJ/db=6.

155
00:11:32,850 --> 00:11:36,274
І, знову ж, це міркування щодо 2-ої частини аргументу.

156
00:11:36,274 --> 00:11:43,370
Давай дізнаємось як зміниться J, якщо ми збільшимо u на 0,002.

157
00:11:43,370 --> 00:11:48,746
Те, що dJ/du=3, каже нам, що якщо

158
00:11:48,746 --> 00:11:54,310
збільшити u на 0,002, то J збільшиться на втричі більшу величину.

159
00:11:54,310 --> 00:11:59,943
Тобто J повинно збільшитись на 0,006.

160
00:11:59,943 --> 00:12:05,670
Це ми бачимо з того, що dJ/du=3.

161
00:12:05,670 --> 00:12:09,351
Якщо ти проведеш детальні обчислення,

162
00:12:09,351 --> 00:12:13,891
то побачиш, що коли b стає 3,001, то u стає 6,002,

163
00:12:13,891 --> 00:12:20,190
v стає 11,002.

164
00:12:20,190 --> 00:12:24,064
А це - a+u, тобто 5+u.

165
00:12:24,064 --> 00:12:28,450
А J, яке =3v,

166
00:12:28,450 --> 00:12:33,101
буде =33,006.

167
00:12:33,101 --> 00:12:37,695
Ось як ми отримуємо, що dJ/db=6.

168
00:12:37,695 --> 00:12:43,738
Тож підставимо це, підемо в зворотньому напрямку. Тож db=6.

169
00:12:43,738 --> 00:12:50,347
db - це назва змінної в Python для dJ/db.

170
00:12:50,347 --> 00:12:53,565
Я не буду вдаватись в деталі в останньому кроці,

171
00:12:53,565 --> 00:13:00,423
бо, обчислюючи dJ [/dc],

172
00:13:00,423 --> 00:13:05,748
ми побачимо, що це - dJ/du помножене на du/dc.

173
00:13:05,748 --> 00:13:09,987
А це буде 9, тобто 3*3.

174
00:13:09,987 --> 00:13:11,950
Не будемо вдаватись в деталі.

175
00:13:11,950 --> 00:13:18,720
Тож в цьому останньому кроці, ми зможемо виявити, що dc=9.

176
00:13:20,060 --> 00:13:24,634
Що ми повинні винести з цього відео, з цього прикладу, 
це те, що обчислюючи

177
00:13:24,634 --> 00:13:29,347
всі ці [часткові] похідні, найбільш ефективно буде

178
00:13:29,347 --> 00:13:34,221
робити це справа-наліво, в напрямку червоних стрілок.

179
00:13:34,221 --> 00:13:37,780
В цьому конкретному випадку 
ми спочатку обчислюємо [часткову] похідну по v,

180
00:13:37,780 --> 00:13:40,530
і далі це допоможе нам

181
00:13:40,530 --> 00:13:45,410
обчислити [часткову] похідну по a і [часткову] похідну по u.

182
00:13:45,410 --> 00:13:48,070
А потім [часткова] похідна по u, наприклад,

183
00:13:48,070 --> 00:13:52,020
ось цей вираз і ось цей вираз

184
00:13:52,020 --> 00:13:55,430
в свою чергу допоможуть обчислити [часткову] похідну по b

185
00:13:55,430 --> 00:13:57,610
і [часткову] похідну по c.

186
00:13:57,610 --> 00:14:02,370
Тож це була Діаграма обчислень, 
що спочатку обчислюється зліва-направо,

187
00:14:02,370 --> 00:14:07,620
щоб обчислити функцію Витрат, 
таку як J, яку ми хочемо оптимізувати.

188
00:14:07,620 --> 00:14:12,940
А потім - у зворотному напрямку, 
тобто справа-наліво, щоб обчислити похідні.

189
00:14:12,940 --> 00:14:15,422
Якщо ти недостатньо ознайомлений/а з диф.численням 
чи ланцюговим правилом

190
00:14:15,422 --> 00:14:18,382
(я розумію, що деякі деталі ми швиденько пробігли),

191
00:14:18,382 --> 00:14:21,500
якщо ти не зрозумів/ла всій деталей, не переймайся.

192
00:14:21,500 --> 00:14:22,567
У наступному відео

193
00:14:22,567 --> 00:14:26,251
ми ще раз пройдемось по них в контексті логістичної регресії (ЛР).

194
00:14:26,251 --> 00:14:30,337
І покажемо що саме необхідно робити, щоб реалізувати обчислення,

195
00:14:30,337 --> 00:14:33,780
які потрібні для обчислення похідних моделі ЛР.
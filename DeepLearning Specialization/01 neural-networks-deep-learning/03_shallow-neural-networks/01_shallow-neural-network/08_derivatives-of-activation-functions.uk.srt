1
00:00:00,302 --> 00:00:04,340
Коли ми реалізуємо зворотне поширення 
для нейронної мережі (НМ), то потрібно

2
00:00:04,340 --> 00:00:07,813
вміти обчислювати нахил або похідну функції активації.

3
00:00:07,813 --> 00:00:11,333
Тож давай розглянемо як вибрати функцію активації і

4
00:00:11,333 --> 00:00:14,025
як обчислити нахил цієї функції.

5
00:00:14,025 --> 00:00:17,239
Ось вже знайома сигмоїдальна функція активації.

6
00:00:17,239 --> 00:00:22,252
Для будь-якого значення z, скажімо оцього, ця функція

7
00:00:22,252 --> 00:00:27,184
матиме деякий нахил або деяку похідну, 
що відповідатиме (якщо намалювати

8
00:00:27,184 --> 00:00:32,389
тут маленьку лінію) відношенню висоти до ширини 
оцього маленького трикутника. 
[протилежного катета до прилеглого]

9
00:00:32,389 --> 00:00:39,823
Тож якщо g(z) - сигмоїда, то нахил функції =(d/dz)*g(z).

10
00:00:39,823 --> 00:00:47,034
Або, як ми знаємо з диференціального числення 
(диф.числення), - нахил g(z) в точці z.

11
00:00:47,034 --> 00:00:52,513
Якщо ти знайомий/а з диф.численням і знаєш як брати похідні,

12
00:00:52,513 --> 00:00:56,074
то знаєш, якщо брати похідну сигмоїди,

13
00:00:56,074 --> 00:01:00,300
то можна показати, що ми отримаємо оцю формулу.

14
00:01:00,300 --> 00:01:02,380
Знову ж таки, я не буду показувати кроки диф.числення.

15
00:01:02,380 --> 00:01:04,839
Але якщо ти знайомий/а з диф.численням,

16
00:01:04,839 --> 00:01:08,465
не вагайся поставити відео на паузу і довести це для себе.

17
00:01:08,465 --> 00:01:16,583
Тож, це =g(z)*(1-g(z)).

18
00:01:16,583 --> 00:01:20,923
Давай переконаємось в правдивості цієї формули.

19
00:01:20,923 --> 00:01:26,343
По-перше, якщо z дуже велике, скажімо z=10,

20
00:01:26,343 --> 00:01:30,315
то g(z) буде близьким до 1 і,

21
00:01:30,315 --> 00:01:38,758
згідно формули зліва, (d/dz)*g(z) буде близьким до g(z),

22
00:01:38,758 --> 00:01:42,979
що =1*(1-1),

23
00:01:42,979 --> 00:01:46,851
що, в результаті, буде близьким до 0.

24
00:01:46,851 --> 00:01:51,267
І це справді вірно, бо коли z дуже велике, нахил наближається до 0.

25
00:01:51,267 --> 00:01:58,885
І, навпаки, якщо z=-10 (знаходиться отут), то g(z) наближається до 0.

26
00:01:58,885 --> 00:02:01,765
Тож, згідно формули зліва,

27
00:02:01,765 --> 00:02:07,333
(d/dz)*g(z) буде наближатись до g(z), що =0*(1-0),

28
00:02:07,333 --> 00:02:10,005
тобто дуже близьке до 0, що теж правильно.

29
00:02:10,005 --> 00:02:16,889
Нарешті, якщо z=0, то g(z)=1/2.

30
00:02:16,889 --> 00:02:18,983
Ось ця точка сигмоїди.

31
00:02:18,983 --> 00:02:24,040
І, отже, похідна =(1/2)*(1-1/2),

32
00:02:24,040 --> 00:02:28,459
що =1/4.

33
00:02:28,459 --> 00:02:33,135
І це, дійсно, виявляється правильним значенням похідної або

34
00:02:33,135 --> 00:02:35,831
нахилу цієї функції при z=0.

35
00:02:35,831 --> 00:02:38,839
Також, представлю ще деякі позначення.

36
00:02:38,839 --> 00:02:42,321
Інколи, замість того, щоб писати оце,

37
00:02:42,321 --> 00:02:46,087
похідна скорочено позначається g штрих (z).

38
00:02:46,087 --> 00:02:52,167
Тож g'(z) (в диф.численні ця риска називається штрихом)...

39
00:02:52,167 --> 00:02:55,283
Тож g'(z) - це скорочене позначення

40
00:02:55,283 --> 00:03:00,455
похідної функції g по змінній z в диф.численні.

41
00:03:00,455 --> 00:03:07,513
В НМ ми маємо a=g(z),

42
00:03:07,513 --> 00:03:11,351
= оцьому.

43
00:03:11,351 --> 00:03:17,145
Тоді ця формула також спрощується до a(1-a).

44
00:03:17,145 --> 00:03:20,109
Інколи в реалізації

45
00:03:20,109 --> 00:03:25,256
ти можеш побачити щось типу g'(z)=a(1-a).

46
00:03:25,256 --> 00:03:29,040
То це лише позначення того, що g',

47
00:03:29,040 --> 00:03:33,428
що означає похідну, = оцьому отут.

48
00:03:33,428 --> 00:03:38,397
Перевага цієї формули в тому, що коли вже обчислено значення a,

49
00:03:38,397 --> 00:03:43,078
то, використавши це рівняння, 
можна також швидко обчислити значення

50
00:03:43,078 --> 00:03:45,038
нахилу g'.

51
00:03:45,038 --> 00:03:47,632
Добре. Це була сигмоїдальна функція активації.

52
00:03:47,632 --> 00:03:51,172
Давай тепер розглянемо функцію активації th 
[гіперболічний тангенс].

53
00:03:51,172 --> 00:03:56,311
Аналогічно як і до цього, визначення (d/dz)*g(z)

54
00:03:56,311 --> 00:04:01,155
буде нахилом g(z) в точці z.

55
00:04:01,155 --> 00:04:07,747
Якщо глянути на формулу функції гіперболічного тангенсу

56
00:04:07,747 --> 00:04:13,066
і, знаючи диф.числення, то можна взяти похідну і

57
00:04:13,066 --> 00:04:17,359
показати, що вона спрощується до цієї формули.

58
00:04:20,813 --> 00:04:23,997
Використавши скорочене позначення, як і раніше,

59
00:04:23,997 --> 00:04:27,019
ми будемо також називати це g штрих від z.

60
00:04:27,019 --> 00:04:30,941
Тож, якщо хочеш, можеш перевірити цю формулу на правдивість.

61
00:04:30,941 --> 00:04:37,005
Наприклад, якщо z=10, то th(z) наближатиметься до 1.

62
00:04:37,005 --> 00:04:41,309
Оце знаходиться в межах від +1 до -1.

63
00:04:41,309 --> 00:04:45,183
Тож g'(z), згідно формули,

64
00:04:45,183 --> 00:04:48,148
буде 1-1², тож буде 0.

65
00:04:48,148 --> 00:04:53,930
Тож при дуже великому z нахил наближатиметься до 0.

66
00:04:53,930 --> 00:04:58,760
Навпаки, при дуже маленькому z, скажімо z=-10,

67
00:04:58,760 --> 00:05:02,440
th(z) наближатиметься до -1,

68
00:05:02,440 --> 00:05:07,871
а g'(z) наближатиметься до 1-(-1)²,

69
00:05:07,871 --> 00:05:12,792
а це буде 1-1, тобто наближатиметься до 0.

70
00:05:12,792 --> 00:05:18,421
І, нарешті, якщо z=0, то th(z)=0.

71
00:05:18,421 --> 00:05:22,165
І тоді нахил буде =1,

72
00:05:22,165 --> 00:05:26,433
що й справді так, якщо z=0.

73
00:05:26,433 --> 00:05:33,001
Тож резюмуємо. Якщо a=g(z), а в даному випадку це th(z),

74
00:05:33,001 --> 00:05:38,300
то похідна g'(z)=1-a².

75
00:05:38,300 --> 00:05:42,000
Тож ще раз, якщо ми вже обчислили значення a,

76
00:05:42,000 --> 00:05:46,522
то можна використати цю формулу, щоб обчислити також і похідну.

77
00:05:46,522 --> 00:05:49,618
Врешті-решт, розглянемо як обчислити похідну 
для випрямленого лінійного вузла (ВЛВ) і

78
00:05:49,618 --> 00:05:51,338
нещільного ВЛВ як функцій активації.

79
00:05:51,338 --> 00:05:57,866
Для ВЛВ g(z)=max(0, z).

80
00:05:57,866 --> 00:06:03,330
Тож похідна, виявляється, буде =0,

81
00:06:03,330 --> 00:06:09,066
якщо z<0, і =1, якщо z>0.

82
00:06:09,066 --> 00:06:15,498
Технічно похідна є невизначеною для z=0.

83
00:06:15,498 --> 00:06:18,339
При програмній реалізації

84
00:06:18,339 --> 00:06:21,398
це, можливо, не на 100% математично правильно.

85
00:06:21,398 --> 00:06:25,571
Але працює як слід, при z точно =0,

86
00:06:25,571 --> 00:06:30,501
якщо ми прирівняємо його до 0 чи до 1.

87
00:06:30,501 --> 00:06:31,781
Це, типу, не має значення.

88
00:06:31,781 --> 00:06:33,578
Якщо ти експерт з оптимізації,

89
00:06:33,578 --> 00:06:37,109
то технічно g' стає так званим субградієнтом

90
00:06:37,109 --> 00:06:41,360
функції активації g(z), тому Градієнтний спуск працюватиме.

91
00:06:41,360 --> 00:06:47,327
Але можна також вважати, що ймовірність, 
що z буде =0,000000..., тобто

92
00:06:47,327 --> 00:06:52,805
дуже малим, 
що практично не матиме значення до чого ми прирівняємо

93
00:06:52,805 --> 00:06:54,303
похідну при z=0.

94
00:06:54,303 --> 00:06:59,155
Тож на практиці реалізація похідної відбувається ось так.

95
00:06:59,155 --> 00:07:03,712
І, нарешті, якщо ми тренуємо НМ з

96
00:07:03,712 --> 00:07:06,882
нещільним ВЛВ як функцією активації,

97
00:07:06,882 --> 00:07:12,244
то g(z) буде =max(0.01z, z).

98
00:07:12,244 --> 00:07:15,247
І, отже, g'(z) буде =0,01,

99
00:07:15,247 --> 00:07:19,074
якщо z<0, і =1, якщо z>0.

100
00:07:19,074 --> 00:07:20,477
Тож, ще раз.

101
00:07:20,477 --> 00:07:26,403
Технічно, градієнт невизначений коли z точно =0.

102
00:07:26,403 --> 00:07:31,479
Але якщо в коді реалізації ми визначимо похідну або

103
00:07:31,479 --> 00:07:38,353
призначимо g' або 0,01 або 1 (це несуттєво)

104
00:07:38,353 --> 00:07:41,499
при z точно =0. То код працюватиме.

105
00:07:41,499 --> 00:07:45,594
Тож, маючи ці формули, ти вже можеш обчислювати нахили або

106
00:07:45,594 --> 00:07:48,400
похідні функцій активації.

107
00:07:48,400 --> 00:07:50,553
Тепер, маючи цей будівельний блок,

108
00:07:50,553 --> 00:07:54,502
ти готовий/а побачити реалізацію Градієнтного блоку для НМ.

109
00:07:54,502 --> 00:07:57,309
Давай перейдемо до наступного відео, щоб це побачити.
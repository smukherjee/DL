1
00:00:00,510 --> 00:00:01,280
在上一段影片中

2
00:00:01,280 --> 00:00:06,130
我們做的例子是使用
計算圖形來計算函數 J

3
00:00:06,130 --> 00:00:09,311
現在, 讓我們用清理乾淨的計算圖形版本
來教您如何使用它

4
00:00:09,311 --> 00:00:13,990
顯示如何使用它來
計算導數

5
00:00:13,990 --> 00:00:15,252
對於函數 Ｊ

6
00:00:15,252 --> 00:00:17,292
這是一個計算圖形

7
00:00:17,292 --> 00:00:22,280
假設說您想計算
J 的導數相對於 v

8
00:00:23,440 --> 00:00:24,126
所以這是什麼?

9
00:00:24,126 --> 00:00:27,800
這是說
如果我們拿這個 v 的值

10
00:00:27,800 --> 00:00:32,360
改變一點點
 J 的值會怎樣改變?

11
00:00:32,360 --> 00:00:37,553
Ｊ是定義為 3 乘 v

12
00:00:37,553 --> 00:00:42,895
現在 v 等於 11

13
00:00:42,895 --> 00:00:48,348
所以如果您提升 v
一點點到 11.001

14
00:00:48,348 --> 00:00:52,524
Ｊ, 也就是 3v
現在是 33

15
00:00:52,524 --> 00:00:56,130
會上升到 33.003

16
00:00:56,130 --> 00:00:59,123
所以這裡
我們的 v 增加 0.001

17
00:00:59,123 --> 00:01:03,640
而淨結果是
J 增加了 3 倍之多

18
00:01:03,640 --> 00:01:08,099
所以 J 導數
相對於 v 等於 3

19
00:01:08,099 --> 00:01:12,590
因為 J 的增加
3 倍於 v 的增加

20
00:01:12,590 --> 00:01:18,221
實際上
這是很類似

21
00:01:18,221 --> 00:01:24,670
我們之前影片的例子
我們有 f(a) = 3a

22
00:01:24,670 --> 00:01:30,765
我們推導出 df/da
稍微簡化

23
00:01:30,765 --> 00:01:36,740
稍微馬虎的記號
您可以寫成 df/da = 3

24
00:01:36,740 --> 00:01:41,829
於是，在這裡我們有 J = 3v

25
00:01:41,829 --> 00:01:44,825
所以 dJ/dv = 3

26
00:01:44,825 --> 00:01:51,713
這裡, Ｊ扮演了 f 的角色

27
00:01:51,713 --> 00:01:58,323
v 扮演了 a 的角色
在我們之前影片中的例子

28
00:01:58,323 --> 00:02:03,595
我們看到用
反向傳播的術語是

29
00:02:03,595 --> 00:02:09,617
如果您想計算
最後變數的導數

30
00:02:09,617 --> 00:02:13,475
也通常是
您最關心的變數

31
00:02:13,475 --> 00:02:18,790
相對於 v, 
那我們已經完成反向傳播的第一個步驟

32
00:02:18,790 --> 00:02:22,240
我們稱之為這個圖形
的一個反向步驟

33
00:02:22,240 --> 00:02:24,280
現在讓我們看另一個例子

34
00:02:24,280 --> 00:02:28,180
dJ/da 是什麼?

35
00:02:28,180 --> 00:02:33,670
換句話說, 如果我們提升一點 a 的值
J 的值會怎樣影響

36
00:02:35,420 --> 00:02:39,965
讓我們用這個例子走下去
現在 a = 5

37
00:02:39,965 --> 00:02:42,850
讓我們提升它成為 5.001

38
00:02:42,850 --> 00:02:48,790
淨影響是對於 v
也就是 a + u, 先前是 11

39
00:02:48,790 --> 00:02:52,359
會增加成為 11.001

40
00:02:52,359 --> 00:02:57,224
而我們已經從上面得知

41
00:02:57,224 --> 00:03:01,672
J 現在提升成為 33.003

42
00:03:01,672 --> 00:03:07,591
所以我們看到如果您
將 a 增加 0.001, J 則會增加 0.003

43
00:03:07,591 --> 00:03:11,751
而所謂增加 a, 我的意思是
您拿這個 5 的值

44
00:03:11,751 --> 00:03:14,100
代進去這個新的值

45
00:03:14,100 --> 00:03:17,954
那 a 的改變會傳播到
計算圖形的右邊, 所以

46
00:03:17,954 --> 00:03:19,832
最後 J 會成為 33.003

47
00:03:19,832 --> 00:03:28,110
J 的增加會是
3 倍於 a 的增加

48
00:03:28,110 --> 00:03:31,520
這個意思是
導數等於 3

49
00:03:31,520 --> 00:03:37,400
一種方式來分解它是
說如果您改變 a

50
00:03:37,400 --> 00:03:38,910
那會改變 v

51
00:03:40,130 --> 00:03:43,967
而經由改變 v
會改變 J

52
00:03:43,967 --> 00:03:49,554
所以 J 值的淨改變
當您提升值時

53
00:03:49,554 --> 00:03:54,313
當您微調 a 的值一點點

54
00:03:57,699 --> 00:04:02,561
首先改變 a
您最終增加 v

55
00:04:02,561 --> 00:04:05,850
好, 那 v 增加多少?

56
00:04:05,850 --> 00:04:11,709
它增加的量
是決定於 dv/da

57
00:04:11,709 --> 00:04:19,802
然後 v 的改變引起
J 的值也會增加

58
00:04:19,802 --> 00:04:27,064
所以微積分中稱為
連鎖律, 如果 a 影響 v

59
00:04:27,064 --> 00:04:32,023
影響 J
那 J 改變的量當您

60
00:04:32,023 --> 00:04:36,866
微調 a 時
 v 的改變量, 當您

61
00:04:36,866 --> 00:04:42,165
微調 a 乘上 
 J 的改變量, 當您微調 v 時

62
00:04:42,165 --> 00:04:46,225
在微積分
這是稱為連鎖律

63
00:04:46,225 --> 00:04:52,140
而從計算中, 我們看到
如果您增加 a 0.001

64
00:04:52,140 --> 00:04:55,250
v 會改變同樣的量

65
00:04:55,250 --> 00:04:59,650
所以 dv/da = 1

66
00:04:59,650 --> 00:05:07,774
實際上, 如果您代入
我們之前的結論

67
00:05:07,774 --> 00:05:11,700
dv/dj = 3 而 dv/da = 1

68
00:05:11,700 --> 00:05:14,160
所以這個 3 乘 1 的乘積

69
00:05:14,160 --> 00:05:18,350
實際上給您
正確的值 dj/da = 3

70
00:05:18,350 --> 00:05:24,963
這個小小的描述顯示了
如何來計算 dJ/dv

71
00:05:24,963 --> 00:05:30,183
也就是
相對於這個變數的導數

72
00:05:30,183 --> 00:05:34,030
可以幫助您計算 dJ/da

73
00:05:34,030 --> 00:05:37,270
所以這是
反向計算的另一個步驟

74
00:05:39,900 --> 00:05:44,115
我這裡要引入
一個新的記號約定

75
00:05:44,115 --> 00:05:50,005
也就是當您在
建置反向傳播時, 寫程式時

76
00:05:50,005 --> 00:05:54,675
總是會有一些最終輸出變數
您真的很在乎

77
00:05:54,675 --> 00:06:01,065
最終輸出變數您真的最關心
或者您想要做最佳化

78
00:06:01,065 --> 00:06:04,100
這種情況下
最後輸出變數是 J

79
00:06:04,100 --> 00:06:07,460
其實是在您的計算圖形
的最終節點

80
00:06:07,460 --> 00:06:11,870
所以很多的計算會是
試著計算那個

81
00:06:11,870 --> 00:06:13,343
最終輸出變數的導數

82
00:06:13,343 --> 00:06:17,100
所以 d of 這個最終變數
相對於其他的變數

83
00:06:17,100 --> 00:06:23,319
我們姑且稱之為 dvar

84
00:06:23,319 --> 00:06:27,909
所以您會有很多的計算
來計算最終

85
00:06:27,909 --> 00:06:32,164
輸出變數, 這個例子是 J
相對於中間變數

86
00:06:32,164 --> 00:06:34,520
像是 a, b, c, u 或者 v

87
00:06:34,520 --> 00:06:41,280
而當您建置軟體時
您如何稱呼這些變數名稱?

88
00:06:41,280 --> 00:06:44,208
您可以在 Python 做的是

89
00:06:44,208 --> 00:06:50,280
您可以給我們一個很長的變數名稱
像是 dFinalOutputVar/dvar

90
00:06:50,280 --> 00:06:51,766
但這實在是很長的變數名稱

91
00:06:51,766 --> 00:06:55,018
您可以直接稱之為 dJdvar

92
00:06:55,018 --> 00:06:58,929
但因為您總是取
對於 dJ 的導數，也就是

93
00:06:58,929 --> 00:07:03,173
對於這個最終的輸出變數
我將引入新的符號

94
00:07:03,173 --> 00:07:09,635
在程式中, 當您計算
這個東西在程式中

95
00:07:09,635 --> 00:07:16,936
我們將使用變數名稱
dvar, 為了表示這個量

96
00:07:16,936 --> 00:07:21,459
所以在程式中 dvar 
表示

97
00:07:21,459 --> 00:07:25,444
您關心的最終輸出變數像是 J 的導數

98
00:07:25,444 --> 00:07:29,938
有時候, 最後這個 l 
相對於一些中間量

99
00:07:29,938 --> 00:07:31,795
您會在您程式中計算

100
00:07:31,795 --> 00:07:38,380
在您的程式中這個東西
您用 dv 來記這個值

101
00:07:38,380 --> 00:07:42,453
所以 dv 會等於 3

102
00:07:42,453 --> 00:07:46,635
您的程式裡
您用 da 代表這個

103
00:07:46,635 --> 00:07:51,185
我們發現
這個也是等於 3

104
00:07:51,185 --> 00:07:58,018
我們已經用這個計算圖形
做部分的反向傳播

105
00:07:58,018 --> 00:08:02,130
讓我們在下一張投影片
完成其他的部分

106
00:08:02,130 --> 00:08:06,293
讓我們用乾淨的
計算圖形副本

107
00:08:06,293 --> 00:08:09,846
重述一遍, 我們已經做到

108
00:08:09,846 --> 00:08:14,743
目前為止, 反向到
發現 dv = 3

109
00:08:14,743 --> 00:08:18,783
再提醒一次，dv 的定義
只是在程式裡的變數名稱

110
00:08:18,783 --> 00:08:20,844
實際上應該是 dJ/dv

111
00:08:20,844 --> 00:08:24,303
我們已經發現 da = 3

112
00:08:24,303 --> 00:08:30,470
再一次, da 只是程式中的變數名稱
實際上是 dJ/da 的值

113
00:08:32,332 --> 00:08:39,410
我們有點像波浪舞一樣反向
從這兩個邊線往回走

114
00:08:39,410 --> 00:08:41,262
現在讓我們繼續計算導數

115
00:08:41,262 --> 00:08:44,129
現在讓我們看 u 的值

116
00:08:44,129 --> 00:08:47,473
所以 dJ/du 是什麼？

117
00:08:47,473 --> 00:08:52,153
經過類似的計算
就像我們之前做的一樣

118
00:08:52,153 --> 00:08:54,430
我們從 u = 6 開始

119
00:08:54,430 --> 00:08:57,913
如果您提升 u 到 6.001, 那 v

120
00:08:57,913 --> 00:09:02,700
之前是 11, 提升了 11.001

121
00:09:02,700 --> 00:09:07,978
所以 J 從 33 到 33.003

122
00:09:07,978 --> 00:09:12,190
所以 J 的增加是 3x
所以這是三倍

123
00:09:12,190 --> 00:09:16,760
而對於 u 的分析是
類似於我們對 a 的分析

124
00:09:16,760 --> 00:09:23,884
這實際上計算為
 dJ/dv 乘上 dv/du

125
00:09:23,884 --> 00:09:30,186
而這個我們知道是 3

126
00:09:30,186 --> 00:09:33,800
而這個實際上是 1

127
00:09:33,800 --> 00:09:36,950
所以我們往反向傳播下一步走

128
00:09:36,950 --> 00:09:42,920
我們計算 du 也是等於 3

129
00:09:42,920 --> 00:09:47,240
而 du, 當然是 dJ/du

130
00:09:47,240 --> 00:09:51,570
現在我們詳細往最後一步走

131
00:09:51,570 --> 00:09:54,137
所以 dJ/db 為何?

132
00:09:54,137 --> 00:09:57,255
這裡, 想像如果您允許
去改變 b 的值

133
00:09:57,255 --> 00:10:01,585
而您想調整一下
為了要最小化或者

134
00:10:01,585 --> 00:10:04,040
最大化 J 的值

135
00:10:04,040 --> 00:10:05,340
所以這個函數 J 的導數或者

136
00:10:05,340 --> 00:10:10,860
斜率是多少
當您想改變一下 b 的值

137
00:10:11,880 --> 00:10:15,257
實際上使用微積分的連鎖律

138
00:10:15,257 --> 00:10:18,416
這個可以寫成
兩個東西的乘積

139
00:10:18,416 --> 00:10:24,720
dJ/du 乘上 du/db

140
00:10:24,720 --> 00:10:30,390
原因是如果您
改變 b 一點點

141
00:10:30,390 --> 00:10:34,275
所以 b = 3 變成 3.001

142
00:10:34,275 --> 00:10:38,041
它會影響 J 是因為它先影響 u

143
00:10:38,041 --> 00:10:40,120
所以它會影響 u 多少

144
00:10:40,120 --> 00:10:44,100
u 是定義為 b 乘上 c

145
00:10:44,100 --> 00:10:48,073
這個會從 6

146
00:10:48,073 --> 00:10:53,238
當 b = 3時, 到 6.002

147
00:10:53,238 --> 00:10:59,560
因為 c = 2 在我們的例子裡

148
00:10:59,560 --> 00:11:05,150
這個告訴我們 du/db = 2

149
00:11:05,150 --> 00:11:10,490
因為當您提升 b 0.001
u 會增加兩倍的量

150
00:11:10,490 --> 00:11:15,360
所以 du/db 會等於 2

151
00:11:15,360 --> 00:11:21,430
現在, 我們知道 u 
上升兩倍於 b 上升的量

152
00:11:21,430 --> 00:11:24,460
所以 dJ/du 呢?

153
00:11:24,460 --> 00:11:27,447
我們已經發現
這個等於 3

154
00:11:27,447 --> 00:11:32,850
所以將這兩個相乘
我們發現 dJ/db = 6

155
00:11:32,850 --> 00:11:36,274
再次, 這個是
第二部分論點的原因

156
00:11:36,274 --> 00:11:43,370
也就是我們要知道當 u 上升
 0.002, 會影響 J 多少

157
00:11:43,370 --> 00:11:48,746
dJ/du = 3 的事實
告訴我們當

158
00:11:48,746 --> 00:11:54,310
u 上升 0.002
Ｊ上升了三倍的量

159
00:11:54,310 --> 00:11:59,943
所以 J 應該上升 0.006

160
00:11:59,943 --> 00:12:05,670
這是從
dJ/du = 3 的事實而來的

161
00:12:05,670 --> 00:12:09,351
而如果您用數學來檢驗

162
00:12:09,351 --> 00:12:13,891
您會發現如果 b 變成 3.001

163
00:12:13,891 --> 00:12:20,190
u 變成 6.002, v 變成 11.002

164
00:12:20,190 --> 00:12:24,064
所以那是 a + u, 也就是 5 + u

165
00:12:24,064 --> 00:12:28,450
而 J, 是等於 3 乘 v

166
00:12:28,450 --> 00:12:33,101
最終會等於 33.006

167
00:12:33,101 --> 00:12:37,695
所以這是您如何得到 dJ/db = 6

168
00:12:37,695 --> 00:12:43,738
如果填入這個, 這是當我們
反向走, db = 6

169
00:12:43,738 --> 00:12:50,347
而 db 實際上是在 Python 
程式中的變數名稱對於 dJ/db

170
00:12:50,347 --> 00:12:53,565
我不再詳細走
最後一個項目

171
00:12:53,565 --> 00:13:00,423
但實際上如果
您也要計算 dJ/dc

172
00:13:00,423 --> 00:13:05,748
這會是 dJ/du 乘 du/dc

173
00:13:05,748 --> 00:13:09,987
而這會是 9
實際上是 3 乘 3

174
00:13:09,987 --> 00:13:11,950
我不詳細算那個例子

175
00:13:11,950 --> 00:13:18,720
經過最後一個步驟
它是可以推導出 dc 等於 9

176
00:13:20,060 --> 00:13:24,634
從這段影片的關鍵點是
從這個例子, 也就是當計算

177
00:13:24,634 --> 00:13:29,347
導數跟計算所有這些導數
最有效率的方式是

178
00:13:29,347 --> 00:13:34,221
是經由從右到左
跟隨紅箭頭的方向

179
00:13:34,221 --> 00:13:37,780
特別是，我們首先先計算
相對於 v 的導數

180
00:13:37,780 --> 00:13:40,530
然後這會變得很有用

181
00:13:40,530 --> 00:13:45,410
對於計算相對於 a 的導數
以及相對於 u 的導數

182
00:13:45,410 --> 00:13:48,070
然後相對於 u 的導數

183
00:13:48,070 --> 00:13:52,020
這裡這個項目跟
這裡這個項目

184
00:13:52,020 --> 00:13:55,430
這些變成很有用當計算
相對於 b 的導數及

185
00:13:55,430 --> 00:13:57,610
相對於 c 的導數

186
00:13:57,610 --> 00:14:02,370
所以這是計算圖形跟
如何正向或者從左到右

187
00:14:02,370 --> 00:14:07,620
計算成本函數
像是 J 您想要最佳化

188
00:14:07,620 --> 00:14:12,940
然後反向或者從右到左
來計算導數

189
00:14:12,940 --> 00:14:15,422
如果您不熟悉微積分的連鎖律

190
00:14:15,422 --> 00:14:18,382
我知道一些細節
它們很快跑過去

191
00:14:18,382 --> 00:14:21,500
但如果您跟不上這些細節
不用擔心

192
00:14:21,500 --> 00:14:22,567
在下一個影片中

193
00:14:22,567 --> 00:14:26,251
我們會在羅吉斯迴歸分析
複習一遍

194
00:14:26,251 --> 00:14:30,337
告訴您您必須做什麼
來建置這些計算

195
00:14:30,337 --> 00:14:33,780
您需要計算的導數
在羅吉斯迴歸分析中
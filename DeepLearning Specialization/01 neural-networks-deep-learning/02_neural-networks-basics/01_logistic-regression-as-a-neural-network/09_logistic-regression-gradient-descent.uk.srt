1
00:00:00,000 --> 00:00:02,250
Вітаю з поверненням! У цьому відео

2
00:00:02,250 --> 00:00:04,980
ми поговоримо як обчислювати похідні, щоб

3
00:00:04,980 --> 00:00:08,330
реалізувати Градієнтний спуск для логістичної регресії (ЛР).

4
00:00:08,330 --> 00:00:11,040
Що потрібно винести з цього відео - що має бути реалізовано -

5
00:00:11,040 --> 00:00:13,230
це ключові рівняння, що потрібні для

6
00:00:13,230 --> 00:00:17,725
реалізації Градієнтного спуску для ЛР.

7
00:00:17,725 --> 00:00:22,185
Але в цьому відео я не буду робити обчислення в Діаграмі обчислень.

8
00:00:22,185 --> 00:00:25,320
Мушу відмітити, що використання Діаграми обчислень дещо

9
00:00:25,320 --> 00:00:29,342
зайве для виведення Градієнтного спуску для ЛР.

10
00:00:29,342 --> 00:00:31,183
Проте, хочу почати пояснювати таким чином,

11
00:00:31,183 --> 00:00:33,975
щоб ти міг/ла ознайомитись з основними ідеями, які,

12
00:00:33,975 --> 00:00:38,370
надіюсь, стануть зрозумілішими 
коли ми будемо говорити про повноцінні нейронні мережі (НМ).

13
00:00:38,370 --> 00:00:44,235
Тож, відштовхуючись від цього, 
давай заглибимось в Градієнтний спуск для ЛР.

14
00:00:44,235 --> 00:00:49,070
Згадаймо, що ми записуємо ЛР наступним чином.

15
00:00:49,070 --> 00:00:53,220
Передбачення ŷ записуються ось так,

16
00:00:53,220 --> 00:00:56,490
де z дорівнює ось цьому.

17
00:00:56,490 --> 00:01:01,800
Якщо ми розглянемо лише 1 зразок зараз, то Втрата

18
00:01:01,800 --> 00:01:03,630
по відношенню до цього зразка

19
00:01:03,630 --> 00:01:05,190
визначається ось так.

20
00:01:05,190 --> 00:01:07,855
Де a - результат ЛР,

21
00:01:07,855 --> 00:01:10,535
а y - емпіричні (Ground Truth) мітки.

22
00:01:10,535 --> 00:01:15,735
Тож давай запишемо це в Діаграмі обчислень. Наприклад,

23
00:01:15,735 --> 00:01:20,520
скажімо, ми маємо лише 2 характеристики x₁ та x₂.

24
00:01:20,520 --> 00:01:22,860
Щоб обчислити z

25
00:01:22,860 --> 00:01:27,030
нам потрібно, крім значень характеристик x₁ та x₂,

26
00:01:27,030 --> 00:01:31,130
додати на вхід також w₁, w₂ і b.

27
00:01:31,130 --> 00:01:33,705
Ці величини в Діаграмі обчислень

28
00:01:33,705 --> 00:01:36,910
використовуються для обчислення z, яке =

29
00:01:36,910 --> 00:01:41,588
w₁x₁+w₂x₂+b.

30
00:01:41,588 --> 00:01:45,380
Обведемо це прямокутником.

31
00:01:45,380 --> 00:01:48,555
А потім ми обчислюємо ŷ

32
00:01:48,555 --> 00:01:52,244
або a=σ(z).

33
00:01:52,244 --> 00:01:55,740
Це наступний крок в Діаграмі обчислень. І, нарешті,

34
00:01:55,740 --> 00:01:58,725
ми обчислюємо L(a, y).

35
00:01:58,725 --> 00:02:01,840
Я не буду копіювати ще раз формулу.

36
00:02:01,840 --> 00:02:06,900
Тож, в ЛР ми хочемо коригувати параметри

37
00:02:06,900 --> 00:02:12,830
w і b, щоб зменшити цю Втрату.

38
00:02:12,830 --> 00:02:15,870
Ми описали кроки прямого поширення, що показують як

39
00:02:15,870 --> 00:02:19,280
обчислити Втрату для окремого тренувального зразка

40
00:02:19,280 --> 00:02:23,940
Тепер давай поговоримо як піти у зворотному напрямку, 
щоб обчислити похідні.

41
00:02:23,940 --> 00:02:26,025
Візьмемо цю діаграму,

42
00:02:26,025 --> 00:02:30,690
так як ми хочемо обчислити похідні відносно цієї Втрати.

43
00:02:30,690 --> 00:02:33,570
Перше, що потрібно зробити у зворотному напрямку - це

44
00:02:33,570 --> 00:02:38,010
обчислити похідну Втрати по відношенню до

45
00:02:38,010 --> 00:02:41,940
оцього сценарію, по змінній a.

46
00:02:41,940 --> 00:02:43,570
Тож, в коді,

47
00:02:43,570 --> 00:02:49,000
ми будемо позначати цю змінну просто da.

48
00:02:49,000 --> 00:02:52,725
Якщо ти знайомий/а з диф.численням,

49
00:02:52,725 --> 00:03:02,004
то можеш вивести, що це =-y/a+(1-y)/(1-a).

50
00:03:02,004 --> 00:03:06,185
Щоб це зробити потрібно взяти формулу Втрати і,

51
00:03:06,185 --> 00:03:07,535
якщо ти знайомий/а з диф.численням,

52
00:03:07,535 --> 00:03:10,515
обчислити похідну відносно змінної позначеної

53
00:03:10,515 --> 00:03:12,792
маленькою a. Ти отримаєш цю формулу.

54
00:03:12,792 --> 00:03:15,280
Проте, якщо ти не знайомий/а з диф.численням, не переймайся.

55
00:03:15,280 --> 00:03:17,960
Ми будемо давати формули похідних

56
00:03:17,960 --> 00:03:20,100
і все, що необхідно, в цьому курсі.

57
00:03:20,100 --> 00:03:21,185
Тож, якщо ти експерт з диф.числення,

58
00:03:21,185 --> 00:03:24,590
то заохочую тебе взяти формулу Втрати з

59
00:03:24,590 --> 00:03:29,504
попереднього слайду і спробувати обчислити похідну по a, 
використовуючи диф.числення.

60
00:03:29,504 --> 00:03:32,635
Але якщо ти недостатньо знаєш диф.числення, не хвилюйся.

61
00:03:32,635 --> 00:03:35,491
Тепер, коли ми обчислили рівняння da,

62
00:03:35,491 --> 00:03:38,825
тобто похідну або остаточну змінну по a,

63
00:03:38,825 --> 00:03:40,715
ми можемо продовжити зворотний рух.

64
00:03:40,715 --> 00:03:45,525
Виявляється, що dz можна показати як

65
00:03:45,525 --> 00:03:47,648
(це назва змінної в Python)

66
00:03:47,648 --> 00:03:51,200
похідну Втрати

67
00:03:51,200 --> 00:03:53,618
по z. Або ж замість L

68
00:03:53,618 --> 00:03:59,850
ми можемо записати Втрату, включаючи a та y як параметри.

69
00:03:59,850 --> 00:04:04,230
Обидва позначення прийнятні.

70
00:04:04,230 --> 00:04:09,605
Ми можемо побачити, що це =a-y.

71
00:04:09,605 --> 00:04:14,685
Кілька коментарів для експертів з диф.числення.

72
00:04:14,685 --> 00:04:16,795
Якщо ти не експерт з диф.числення, не переймайся.

73
00:04:16,795 --> 00:04:20,320
Виявляється, що dL/dz

74
00:04:20,320 --> 00:04:27,850
може бути записано як dL/da помножене на da/dz.

75
00:04:27,850 --> 00:04:29,940
І, виявляється, що da/dz

76
00:04:29,940 --> 00:04:33,755
буде a(1-a),

77
00:04:33,755 --> 00:04:37,800
а dL/da, як ми вже побачили, - ось цим.

78
00:04:37,800 --> 00:04:41,530
Тож якщо ми візьмемо ці 2 рівняння: dL/da,

79
00:04:41,530 --> 00:04:43,846
що = оцьому, і da/dz,

80
00:04:43,846 --> 00:04:47,165
що = оцьому, і перемножимо їх,

81
00:04:47,165 --> 00:04:51,915
то можна спростити цей добуток до a-y.

82
00:04:51,915 --> 00:04:53,220
Тож ось так це виводиться.

83
00:04:53,220 --> 00:04:57,390
Це і є ланцюговим правилом, 
яке скоротило вираз до наведеної форми.

84
00:04:57,390 --> 00:05:02,770
Зрозуміло? Тож не вагайся вивести це самостійно, 
якщо знаєш диф.числення.

85
00:05:02,770 --> 00:05:05,345
Якщо ж не знаєш, то достатньо розуміти, що

86
00:05:05,345 --> 00:05:09,365
dz обчислюється як a-y, а диф.числення ми зробили за тебе.

87
00:05:09,365 --> 00:05:13,010
І останній крок зворотного поширення - повернутись на початок

88
00:05:13,010 --> 00:05:17,480
і визначити наскільки потрібно змінити w і b.

89
00:05:17,480 --> 00:05:24,610
В цьому випадку, можемо побачити, що похідна по w₁ (в коді

90
00:05:24,610 --> 00:05:31,810
ми її називаємо dw1) =x₁*dz.

91
00:05:31,810 --> 00:05:36,485
І, аналогічно, dw2, яка показує наскільки потрібно змінити w₂,

92
00:05:36,485 --> 00:05:39,455
=x₂*dz. А b,

93
00:05:39,455 --> 00:05:42,585
вибачте, db=dz.

94
00:05:42,585 --> 00:05:47,375
Тож, якщо ти хочеш реалізувати Градієнтний спуск 
відносно цього одного зразка,

95
00:05:47,375 --> 00:05:49,280
то потрібно зробити наступне.

96
00:05:49,280 --> 00:05:52,640
Потрібно з допомогою оцієї формули обчислити dz,

97
00:05:52,640 --> 00:05:56,707
а потім з допомогою оцих формул обчислити dw1, dw2

98
00:05:56,707 --> 00:06:01,170
і db, а потім провести оці коригування:

99
00:06:01,170 --> 00:06:04,538
w₁ коригується як w₁ мінус

100
00:06:04,538 --> 00:06:06,575
навчальний темп α, помножений на dw1;

101
00:06:06,575 --> 00:06:09,245
w₂ коригується аналогічно,

102
00:06:09,245 --> 00:06:14,170
а b коригується як навчальний темп, помножений на db.

103
00:06:14,170 --> 00:06:18,860
Тож це буде один крок обчислень (бо стосується одного зразка).

104
00:06:18,860 --> 00:06:22,130
Тож ти побачив/ла як обчислювати похідні і застосовувати

105
00:06:22,130 --> 00:06:27,200
Градієнтний спуск для ЛР 
для одного тренувального зразка.

106
00:06:27,200 --> 00:06:28,987
Проте, коли ми тренуємо модель ЛР,

107
00:06:28,987 --> 00:06:34,700
ми маємо не один тренувальний зразок, 
а тренувальний набір з m тренувальних зразків.

108
00:06:34,700 --> 00:06:36,120
У наступному відео

109
00:06:36,120 --> 00:06:39,350
давай розглянемо як ці ідеї можна застосувати для навчання

110
00:06:39,350 --> 00:06:40,760
не лише одного зразка,

111
00:06:40,760 --> 00:06:42,400
а для всього тренувального набору.